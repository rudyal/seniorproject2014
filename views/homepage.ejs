<html>
  <head>
    <title>Insert Forum Title</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/stylesheets/style2.css">
  	<script type='text/javascript' src='/javascripts/jquery-1.11.0.js'></script>
    <script type='text/javascript' src="/javascripts/angular.min.js"></script>
    <script type='text/javascript' src="/javascripts/angular-ui-router.min.js"></script>
    <script type='text/javascript' src='/javascripts/infinite.js'></script>
    <script src="/javascripts/froala_editor.min.js"></script>
    <script src="/javascripts/froala-sanitize.js"></script>
    <script src="/javascripts/angular-froala.js"></script>

	<script src="/javascripts/angularApp.js"></script>
	  <!-- Initialize the editor. -->
	  <script>
		  $(function() {
		    $('textarea#edit').editable({
		      inlineMode: false
		    })
		  });
		</script>
    <base href="/" />
  </head>
  <body>
	<div ng-app="forumBody" ng-controller="BuildCtrl">
  	<nav class="navbar navbar-inverse" role="navigation">
		    <div class="navbar-header">
		    	<div ng-include="nav_partial_url"></div>
		        <a class="navbar-brand" ui-sref="#">Discussion Forums</a>
		    </div>
		    <ul class="nav navbar-nav">
		        <li><a href="/" target="_self">Home</a></li>
		        <li ng-show="!isLoggedIn()"><a href="/login" target="_self">Login</a></li>
		        <li ng-show="!isLoggedIn()"><a href="/signup" target="_self">Sign-up</a></li>
		        <li><a href="/popular" target="_self">Forums</a></li>
		        
		        <li><a href=""  target="_self"> </a></li>
		        <li ng-show="isLoggedIn()"><a href="/logout"  target="_self">logout</a></li>
		        <li ng-show="isLoggedIn()"><a href="/profile"  target="_self">Hello, {{user.username}}</a></li>
		        
		    </ul>
		</nav>
  	
		<div class="col-lg-  col-md-offset-1">

			
    		<ui-view></ui-view>
    	</div>

    	<script type="text/ng-template" id="/build.html">

    	<a href="/popular" target="_self">Popular Forums</a>

		<div ng-show="isLoggedIn()">
		    <h2>Create a Forum</h2>       Logged In

		    <form name="buildForumWU">
		  		
		  	<div class="control-group" ng-class="{error: buildForumWU.comname.$invalid}">
						<label>Name</label>
						<input type="text"  placeholder="Community Name" data-wc-unique="{property: 'forumfirst'}" ng-change="changeURL(comname)" name="comname" ng-model="comname" ng-pattern="/^[a-zA-Z][a-zA-Z0-9_ -]{2,25}$/" required> </input>
						
						<div class="invalid" ng-show="buildForumWU.comname.$dirty && buildForumWU.comname.$invalid"><br/>
						    <span class="errorMessage" ng-show="buildForumWU.comname.$error.pattern">Error: Invalid Name<br/></span>
						</div>
				</div>

				<div class="form-group">
					<label>discussone.com/</label>
					<div class="form-group" ng-class="{ 'has-error' : signup.comurl.$invalid && !signup.comurl.$pristine }">
				  		<input type="text" ng-model="comurl" name="comurl" ng-change="updateURL(comurl)" data-wc-unique="{property: 'forum'}" ng-pattern="/^[a-zA-Z][a-zA-Z0-9-]{2,25}$/" required> </input>
				  		<span class="errorMessage" ng-show="buildForumWU.comurl.$dirty && buildForumWU.comurl.$error.unique">URL already in use</span>
				  		<span class="errorMessage" ng-show="buildForumWU.comname.$dirty && buildForumWU.comname.$error.unique">URL already in use</span>
				  		<span class="errorMessage" ng-show="buildForumWU.comurl.$error.pattern">Error: Invalid link<br/></span>
			  		</div>
		  		</div>

		  		
		  		<br>
		  		<label>Access Code</label>
		  		<input type="checkbox" ng-model="accesscode" ng-true-value="yes" ng-false-value="no" >
		  		<input type="text" placeholder="" ng-model="accesscodebox"> </input>
		  		<br>
		  		<label>Allow Registered Users</label>
		  		<input type="checkbox" ng-model="reguserbool" ng-true-value="true" ng-false-value="false" >
		  		<br>
		  		<label>Allow Anonymous Users</label>
		  		<input type="checkbox" ng-model="anonuserbool" ng-true-value="true" ng-false-value="false" >
		  		<br>
		  		<button ng-click="submitForm()" ng-disabled="buildForumWU.$invalid" type="submit">Create</button>

		  	</form>
		</div>

		<div ng-show="!isLoggedIn()">
		    <h2>Create a Forum</h2>              Logged Out

		    <form name="buildForum">
		  		
		  		<div class="control-group" ng-class="{error: buildForum.comname.$invalid}">
						<label>Name</label>
						<input type="text"  placeholder="Community Name" data-wc-unique="{property: 'forumfirst'}" ng-change="changeURL(comname)" name="comname" ng-model="comname" ng-pattern="/^[a-zA-Z][a-zA-Z0-9_ -]{2,25}$/" required> </input>
						
						<div class="invalid" ng-show="buildForum.comname.$dirty && buildForum.comname.$invalid"><br/>
						    <span class="errorMessage" ng-show="buildForum.comname.$error.pattern">Error: Invalid Name<br/></span>
						</div>
				</div>

				<div class="form-group">
					<label>discussone.com/</label>
					<div class="form-group" ng-class="{ 'has-error' : signup.comurl.$invalid && !signup.comurl.$pristine }">
				  		<input type="text" ng-model="comurl" name="comurl" ng-change="updateURL(comurl)" data-wc-unique="{property: 'forum'}" ng-pattern="/^[a-zA-Z][a-zA-Z0-9-]{2,25}$/" required> </input>
				  		<span class="errorMessage" ng-show="buildForum.comurl.$dirty && buildForum.comurl.$error.unique">URL already in use</span>
				  		<span class="errorMessage" ng-show="buildForum.comname.$dirty && buildForum.comname.$error.unique">URL already in use</span>
				  		<span class="errorMessage" ng-show="buildForum.comurl.$error.pattern">Error: Invalid link<br/></span>
			  		</div>
		  		</div>

		  		<div class="form-group">
					<label>Email</label>
					<div class="form-group" ng-class="{ 'has-error' : signup.email.$invalid && !signup.email.$pristine }">
						<input type="email" class="form-control" ng-model="email" data-wc-unique="{property: 'email'}" style="width:200px;" name="email" ng-pattern="/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/" required>
						<span class="errorMessage" ng-show="buildForum.email.$dirty && buildForum.email.$error.unique">Email already in use</span>
						<span class="errorMessage" ng-show="buildForum.email.$error.pattern">Invalid Email<br/></span>
					</div>
				</div>
				<div class="form-group">
					<label>Username</label>
					<div class="control-group" ng-class="{ 'has-error' : signup.username.$invalid && !signup.username.$pristine }">
						<input type="text" class="form-control" ng-model="username"  data-wc-unique="{property: 'username'}" style="width:200px;" name="username" ng-minlength="4" ng-maxlength="22" required>
						<span class="errorMessage" ng-show="buildForum.username.$dirty && buildForum.username.$error.unique">Username already in use</span>

				    </div>
				</div>

				<div class="form-group">
					<label>Password</label>
					<div class="control-group">
					<input type="password" class="form-control" ng-model="password" style="width:200px;" name="password" ng-minlength="6" ng-maxlength="30" ng-pattern="/^[a-zA-Z0-9!@#$%^*]{6,16}$/"  required>
					<span class="errorMessage" ng-show="buildForum.password.$dirty && buildForum.password.$error.pattern">Password Invalid</span>
					 </div>
				</div>

				<br>
		  		<label>Access Code</label>
		  		<input type="checkbox" ng-model="accesscode" ng-true-value="yes" ng-false-value="no" >
		  		<input type="text" placeholder="" ng-model="accesscodebox"> </input>
		  		<br>
		  		<label>Allow Registered Users</label>
		  		<input type="checkbox" ng-model="reguserbool" ng-true-value="true" ng-false-value="false" >
		  		<br>
		  		<label>Allow Anonymous Users</label>
		  		<input type="checkbox" ng-model="anonuserbool" ng-true-value="true" ng-false-value="false" >
		  		<br>

		  		
		  		<button ng-click="submitFormWU()" ng-disabled="buildForum.$invalid" type="submit">Create</button>

		  	</form>


		</div>

    	

		  	</script>

	
   
		<script type="text/ng-template" id="/homepage.html">

		<a href="/" target="_self">Build a Forum</a>
			
		  <div class="page-header">
		    <h3> Home </h3>

		    <p> List of all forums sort by most posts </p>

		    <div ng-repeat="fo in forum | orderBy:'-posts.length'">

		  		<a href="/{{fo.url}}" target="_self">{{fo.title}} </a>
		  		</a> Posts: {{fo.posts.length}} 
				
		  	</div>

		  </div>
		</script>

		
	</div>
  </body>
</html>
